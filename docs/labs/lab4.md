# Project Overview
The goal of this project is to implement an LED pattern generation system on the FPGA with adjustable clock rates. The VHDL code defines whether this pattern generation system is generated by hardware (implemented in this lab) or software (to be implemented in the next lab) using the bit HPS_LED_control.
## Functional Requirements
 When in the hardware control mode (HPS_LED_control = 0), LED7 always blinks at the base clock rate. On the six other LEDs, patterns are displayed as defined below:

- pattern 0: LEDs show one lit LED shifting right at 1/2 the base period.

- pattern 1: LEDs show two lit LEDs side by side, shifting left at 1/4 the base period.

- pattern 2: LEDs show a 7-bit up counter running at twice the base period.

- pattern 3: LEDs show the output of a 7-bit down counter running at 1/8 the base period.

- pattern 4: User defined pattern. This will be discussed in a later section.

## State Diagram

![Lab 4 State Diagram](/docs/assets/Lab4_State_Diagram.jpg)

The LED patterns are controlled by a hardware-defined state machine while not  in the HPS control mode. This state machine defaults to pattern 0. When the push button is pressed, the device displays the slide switch inputs on the bottom 4 LEDs for one second, then determines the next pattern based on the binary value of the switch inputs (I.E. 0001 --> Pattern 1). If the switch input is greater than 4, the device transitions back to the previously displayed pattern. The device remains in this state until the push button is asserted again. The push button is conditioned to debounce the input signal, and provide a single-clock-period pulse when pressed.




# System Architecture

## Block Diagram

![Lab 4 block diagram](/docs/assets/Lab4_Block_Diagram.jpg)

The generation of clocks for each LED pattern is handled in a seperate clock generation component. These clock signals are then passed to their respective pattern generator components, which output the LED patterns desired. These patterns are selected by the LED pattern state machine, and assigned to the FPGA's LEDs based on the current state. Push button zero provides an asyrchronous reset, while push button one is sent through an asynchronous conditioner consisting of a synchronizer, debouncer, and one-pulse converter. This is then used to trigger the transition to the switch input state.



# Implementation Details

## Custom LED Pattern

For pattern 4, the FPGA produces a cascading LED effect. All LEDs begin on, and are turned one at a time from right to left. After the leftmost LED is turned off, the LEDs are relit from right to left. This pattern runs at 1/16 the base period.

## Fixed Point Base Period
The base period is defined in the VHDL as a 8 bit fixed point value in seconds, with 4 whole-number bits and 4 fractional bits. For example, a value of 00010001 would create a base period of 1 1/16 seconds. This can then be converted to a base frequency, and finally a number of clock cycles per period. Because the FPGA runs at a set clock rate, fractional clock cycles are discarded in this step, meaning the base period is rounded to an accuracy of +-20 ns.